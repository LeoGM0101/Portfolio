---
title: "Atividade de Análise Multivariada"
author: "Leonardo Gomes Malaquias"
date: '2023-11-06'
output: html_document
---

```{r}
rm(list=ls())
library("HDclassif")
library("PerformanceAnalytics")
library("FactoMineR")
library("factoextra")
library("tidyverse")

```


```{r}
paises = list(
Argentina = c(10.23, 20.37, 46.18, 1.77, 3.68, 13.33, 27.65, 129.57),
Australia = c(9.93, 20.06, 44.38, 1.74, 3.53, 12.93, 27.53, 127.51),
Austria = c(10.15, 20.45, 45.80, 1.77, 3.58, 13.26, 27.72, 132.22),
Belgium = c(10.14, 20.19, 45.02, 1.73, 3.57, 12.83, 26.87, 127.20),
Bermuda = c(10.27, 20.30, 45.26, 1.79, 3.70, 14.64, 30.49, 146.37),
Brazil = c(10.00, 19.89, 44.29, 1.70, 3.57, 13.48, 28.13, 126.05),
Canada = c(9.84, 20.17, 44.72, 1.75, 3.53, 13.23, 27.60, 130.09),
Chile = c(10.10, 20.15, 45.92, 1.76, 3.65, 13.39, 28.09, 132.19),
China = c(10.17, 20.42, 45.25, 1.77, 3.61, 13.42, 28.17, 129.18),
Columbia = c(10.29, 20.85, 45.84, 1.80, 3.72, 13.49, 27.88, 131.17),
Cook_Islands =c(10.97, 22.46, 51.40, 1.94, 4.24, 16.70, 35.38, 171.26),
Costa_Rica = c(10.32, 20.96, 46.42, 1.87, 3.84, 13.75, 28.81, 133.23),
Czech_Republic = c(10.24, 20.61, 45.77, 1.75, 3.58, 13.42, 27.80, 131.57),
Denmark = c(10.29, 20.52, 45.89, 1.69, 3.52, 13.42, 27.91, 129.43),
Dominican_Republic = c(10.16, 20.65, 44.90, 1.81, 3.73, 14.31, 30.43, 146.00),
Finland = c(10.21, 20.47, 45.49, 1.74, 3.61, 13.27, 27.52, 131.15),
France = c(10.02, 20.16, 44.64, 1.72, 3.48, 12.98, 27.38, 126.36),
Germany = c(10.06, 20.23, 44.33, 1.73, 3.53, 12.91, 27.36, 128.47),
Great_Britain = c(9.87, 19.94, 44.36, 1.70, 3.49, 13.01, 27.30, 127.13),
Greece = c(10.11, 19.85, 45.57, 1.75, 3.61, 13.48, 28.12, 132.04),
Guatemala = c(10.32, 21.09, 48.44, 1.82, 3.74, 13.98, 29.34, 132.53),
Hungary = c(10.08, 20.11, 45.43, 1.76, 3.59, 13.45, 28.03, 132.10),
India = c(10.33, 20.73, 45.48, 1.76, 3.63, 13.50, 28.81, 132.00),
Indonesia = c(10.20, 20.93, 46.37, 1.83, 3.77, 14.21, 29.65, 139.18),
Ireland = c(10.35, 20.54, 45.58, 1.75, 3.56, 13.07, 27.78, 129.15),
Israel = c(10.20, 20.89, 46.59, 1.80, 3.70, 13.66, 28.72, 134.21),
Italy = c(10.01, 19.72, 45.26, 1.73, 3.35, 13.09, 27.28, 127.29),
Japan = c(10.00, 20.03, 44.78, 1.77, 3.62, 13.22, 27.58, 126.16),
Kenya = c(10.28, 20.43, 44.18, 1.70, 3.44, 12.66, 26.46, 124.55),
Korea_South = c(10.34, 20.41, 45.37, 1.74, 3.64, 13.84, 28.51, 127.20),
Korea_North = c(10.60, 21.23, 46.95, 1.82, 3.77, 13.90, 28.45, 129.26),
Luxembourg = c(10.41, 20.77, 47.90, 1.76, 3.67, 13.64, 28.77, 134.03),
Malaysia = c(10.30, 20.92, 46.41, 1.79, 3.76, 14.11, 29.50, 149.27),
Mauritius = c(10.13, 20.06, 44.69, 1.80, 3.83, 14.15, 29.84, 143.07),
Mexico = c(10.21, 20.40, 44.31, 1.78, 3.63, 13.13, 27.14, 127.19),
Myanmar_Burma = c(10.64, 21.52, 48.63, 1.80, 3.80, 14.19, 29.62, 139.57),
Netherlands = c(10.19, 20.19, 45.68, 1.73, 3.55, 13.22, 27.44, 128.31),
New_Zealand = c(10.11, 20.42, 46.09, 1.74, 3.54, 13.21, 27.70, 128.59),
Norway = c(10.08, 20.17, 46.11, 1.71, 3.62, 13.11, 27.54, 130.17),
Papua_New_Guinea = c(10.40, 21.18, 46.77, 1.80, 4.00, 14.72, 31.36, 148.13),
Philippines = c(10.57, 21.43, 45.57, 1.80, 3.82, 13.97, 29.04, 138.44),
Poland = c(10.00, 19.98, 44.62, 1.72, 3.59, 13.29, 27.89, 129.23),
Portugal = c(9.86, 20.12, 46.11, 1.75, 3.50, 13.05, 27.21, 126.36),
Romania = c(10.21, 20.75, 45.77, 1.76, 3.57, 13.25, 27.67, 132.30),
Russia = c(10.11, 20.23, 44.60, 1.71, 3.54, 13.20, 27.90, 129.16),
Samoa  = c(10.78, 21.86, 49.98, 1.94, 4.01, 16.28, 34.71, 161.50),
Singapore = c(10.37, 21.14, 47.60, 1.84, 3.86, 14.96, 31.32, 144.22),
Spain = c(10.17, 20.59, 44.96, 1.73, 3.48, 13.04, 27.24, 127.23),
Sweden = c(10.18, 20.43, 45.54, 1.76, 3.61, 13.29, 27.93, 130.38),
Switzerland = c(10.16, 20.41, 44.99, 1.71, 3.53, 13.13, 27.90, 129.56),
Taiwan = c(10.36, 20.81, 46.72, 1.79, 3.77, 13.91, 29.20, 134.35),
Thailand = c(10.23, 20.69, 46.05, 1.81, 3.77, 14.25, 29.67, 139.33),
TUrkey = c(10.38, 21.04, 46.63, 1.78, 3.59, 13.45, 28.33, 130.25),
USA = c(9.78, 19.32, 43.18, 1.71, 3.46, 12.97, 27.23, 125.38))

esportes = c("100m_(s)", "200m_(s)", "400m_(s)", "800m_(min)", "1500m_(min)", "5000m_(min)",
             "10000m_(min)", "Marathon_(min)")

tabela_paises = do.call(rbind, paises)
dados = data.frame(tabela_paises)
colnames(dados)[1:(length(esportes))] = esportes
dados[1] = dados[1]/60
dados[2] = dados[2]/60
dados[3] = dados[3]/60

dados_longos = tidyr::pivot_longer(dados, cols = c(`100m_(s)`, `200m_(s)`, `400m_(s)`, `800m_(min)`, `1500m_(min)`, `5000m_(min)`,
                                                   `10000m_(min)`, `Marathon_(min)`), names_to = "Variavel", values_to = "Valor")
```


```{r}
estatisticas_descritivas = dados_longos %>%
  group_by(Variavel) %>%
  summarise(Media = mean(Valor),
            Mediana = median(Valor),
            Desvio_Padrao = sd(Valor),
            `IQR` = IQR(Valor),
            Curtose = kurtosis(Valor),
            Simetria = skewness(Valor),
            Minimo = min(Valor),
            Maximo = max(Valor)); estatisticas_descritivas

ggplot(dados_longos, aes(x = Valor)) +
  geom_histogram(color = "black", fill = "lightblue") +
  facet_wrap(~ Variavel, scales = "free") +
  labs(x = "Valores", y = "Frequências", title = "Histogramas das Variáveis") +
  theme_minimal()


outliers = dados_longos %>%
  group_by(Variavel) %>%
  summarise( outliers_inferiores = sum(Valor < quantile(Valor, 0.25) - 1.5 * IQR(Valor)),
             outliers_superiores = sum(Valor > quantile(Valor, 0.75) + 1.5 * IQR(Valor))); outliers

ggplot(dados_longos, aes(x = Variavel, y = Valor)) +
  geom_boxplot() +
  facet_wrap(~ Variavel, scales = "free") +
  labs(x = "Valores", y = "Frequências", title = "Boxplots das Variáveis") +
  theme_minimal()
```



``` {r}
dados.active = dados[1:54, 1:8]
res.pca = PCA(dados.active)
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 90))
fviz_pca_biplot(res.pca)

res.pca$eig

```

  <br> Podemos afirmar que a primeira componente nos indica que os países com um desempenho sólido em provas de curta distância também se destacam nas provas de longa distância. Portanto, é razoável concluir que essa primeira componente está associada ao tempo/desempenho global dos países em todas as provas. A segunda componente, embora represente apenas 7.9% da variação, parece explicar a discrepância no desempenho entre as provas de curta e longa distância. É importante notar que o impacto da segunda componente é relativamente pequeno, uma vez que a primeira componente abrange 83.6% da variação. No entanto, mesmo com essa diferença menor, ainda existe uma distinção no desempenho dos países em provas de diferentes distâncias. Vale ressaltar que quanto mais tempo leva para concluir uma prova, pior é o desempenho.
  
  <br> Ao analisar o gráfico dos países, podemos observar que muitos deles apresentam um desempenho semelhante nas provas, formando um aglomerado. No entanto, a projeção de alguns países mostra discrepâncias em relação aos demais. Por exemplo, os Estados Unidos (USA) estão bem posicionados na primeira componente e situam-se no quadrante negativo em relação à correlação com as provas de curta distância, o que indica que eles têm um desempenho superior nesse tipo de prova. Por outro lado, o Kenya também se destaca na primeira componente, mas está localizado no segundo quadrante, o que sugere um desempenho superior em provas de longa distância em comparação com as provas de curta distância.
  
  <br> Por outro lado, a projeção de países como Cook Island e Samoa evidencia que esses países não tiveram bom desempenho nas provas curtas e nas provas mais longas.
